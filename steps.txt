prompts -> telex lower case
python script/vietnameseToTelex.py c:/Active/WorkingProjects/vivos/train/prompts.txt txt/prompts.txt

prompts -> wlist
perl script/prompts2wlist.pl txt/prompts.txt txt/wlist.txt

tao gram.txt
python script/wlistToGram.py txt/wlist.txt txt/gram.txt

tao wdnet.txt
htk\HParse -T 1 txt/gram.txt txt/wdnet.txt

Tao srcDict
python script/splitWord.py txt/wlist.txt txt/srcDict.txt

Tao HTK Dict & monophones
htk\HDMan -T 1 -m -w txt/wlist.txt -n phones/monophones -l dlog txt/dict.txt txt/srcDict.txt

Tao cac monophones khac
perl script/mkMonophones.pl phones/monophones phones/monophones0 phones/monophones1

Tao transcription file
MLF words
perl script/prompts2mlf.pl mlf/words.mlf txt/prompts.txt

MLF phones
htk\HLEd -T 1 -l '*' -d txt/dict.txt -i mlf/phones0.mlf ins/mkphones0.led mlf/words.mlf
htk\HLEd -T 1 -l '*' -d txt/dict.txt -i mlf/phones1.mlf ins/mkphones1.led mlf/words.mlf

Tao list file train
python script/listwavmfc.py c:/Active/WorkingProjects/vivos/train/waves/ txt/train.scp txt/train_mfc.scp

Tao list file test

Rut dac trung bo train
htk\HCopy -T 1 -C cfg/HCopy.cfg -S txt/train.scp

Tao hmm folder
sh script/mkHmmDir.sh

Tao hmm 0
htk\HCompV -T 1 -C cfg/HCompV.cfg -f 0.01 -m -S txt/train_mfc.scp -M hmm/hmm0 hmm/proto.template
perl script/mkMacrosFile.pl hmm/hmm0/vFloors hmm/hmm0/macros
perl script/mkHmmdefsFile.pl hmm/hmm0/proto phones/monophones0 hmm/hmm0/hmmdefs

Tao hmm 1, 2, 3
htk\HERest -T 1 -C cfg/HERest.cfg -I mlf/phones0.mlf -t 250.0 150.0 1000.0 -S txt/train_mfc.scp -H hmm/hmm0/macros -H hmm/hmm0/hmmdefs -M hmm/hmm1 phones/monophones0
htk\HERest -T 1 -C cfg/HERest.cfg -I mlf/phones0.mlf -t 250.0 150.0 1000.0 -S txt/train_mfc.scp -H hmm/hmm1/macros -H hmm/hmm1/hmmdefs -M hmm/hmm2 phones/monophones0
htk\HERest -T 1 -C cfg/HERest.cfg -I mlf/phones0.mlf -t 250.0 150.0 1000.0 -S txt/train_mfc.scp -H hmm/hmm2/macros -H hmm/hmm2/hmmdefs -M hmm/hmm3 phones/monophones0

Tao hmm 4, 5
perl script/makesp.pl hmm/hmm3/hmmdefs hmm/hmm4/hmmdefs hmm/hmm3/macros hmm/hmm4/macros
htk\HHEd -T 1 -H hmm/hmm4/macros -H hmm/hmm4/hmmdefs -M hmm/hmm5 ins/sil.hed phones/monophones1

Tao hmm 6, 7
htk\HERest -T 1 -C cfg/HERest.cfg -I mlf/phones1.mlf -t 250.0 150.0 1000.0 -S txt/train_mfc.scp -H hmm/hmm5/macros -H hmm/hmm5/hmmdefs -M hmm/hmm6 phones/monophones1
htk\HERest -T 1 -C cfg/HERest.cfg -I mlf/phones1.mlf -t 250.0 150.0 1000.0 -S txt/train_mfc.scp -H hmm/hmm6/macros -H hmm/hmm6/hmmdefs -M hmm/hmm7 phones/monophones1

Re-aligning
cp mlf/phones1.mlf mlf/aligned.mlf
htk\HVite -T 1 -o SWT -b silence -a -H hmm/hmm7/macros -H hmm/hmm7/hmmdefs -i mlf/aligned.mlf -m -t 250.0 -y lab -I mlf/words.mlf -S txt/train_mfc.scp txt/srcDict.txt phones/monophones1
cp mlf/phones1.mlf mlf/aligned.mlf

Tao hmm 8, 9
htk\HERest -T 1 -C cfg/HERest.cfg -I mlf/aligned.mlf -t 250.0 150.0 1000.0 -S txt/train_mfc.scp -H hmm/hmm7/macros -H hmm/hmm7/hmmdefs -M hmm/hmm8 phones/monophones1
htk\HERest -T 1 -C cfg/HERest.cfg -I mlf/aligned.mlf -t 250.0 150.0 1000.0 -S txt/train_mfc.scp -H hmm/hmm8/macros -H hmm/hmm8/hmmdefs -M hmm/hmm9 phones/monophones1

Tao trang thai rang buoc cho triphone
Make triphone from monophone
htk\HLEd -T 1 -n phones/triphones1 -l '*' -i mlf/wintri.mlf ins/mktri.led mlf/aligned.mlf

Tao hmm 10
htk\HHEd -T 1 -B -H hmm/hmm9/macros -H hmm/hmm9/hmmdefs -M hmm/hmm10 ins/mktri.hed phones/monophones1

Tao hmm 11, 12
htk\HERest -T 1 -B -C cfg/HERest.cfg -I mlf/wintri.mlf -t 250.0 150.0 1000.0 -s stats -S txt/train_mfc.scp -H hmm/hmm10/macros -H hmm/hmm10/hmmdefs -M hmm/hmm11 phones/triphones1
htk\HERest -T 1 -B -C cfg/HERest.cfg -I mlf/wintri.mlf -t 250.0 150.0 1000.0 -s stats -S txt/train_mfc.scp -H hmm/hmm11/macros -H hmm/hmm11/hmmdefs -M hmm/hmm12 phones/triphones1

Tao trang thai rang buoc cho triphone
perl script/mkFullList.pl phones/monophones0 phones/fulllist
---> Path file fulllist se duoc su dung lai trong tree.hed
perl script/mkTree.pl 40 phones/monophones0 ins/tree.hed phones/fulllist
htk\HHEd -T 1 -B -H hmm/hmm12/macros -H hmm/hmm12/hmmdefs -M hmm/hmm13 ins/tree.hed phones/triphones1 > log.txt

Tao hmm 14, 15
htk\HERest -T 1 -B -C cfg/HERest.cfg -I mlf/wintri.mlf -t 250.0 150.0 1000.0 -s stats -S txt/train_mfc.scp -H hmm/hmm13/macros -H hmm/hmm13/hmmdefs -M hmm/hmm14 tiedlist
htk\HERest -T 1 -B -C cfg/HERest.cfg -I mlf/wintri.mlf -t 250.0 150.0 1000.0 -s stats -S txt/train_mfc.scp -H hmm/hmm14/macros -H hmm/hmm14/hmmdefs -M hmm/hmm15 tiedlist


Evaluation
Tao prompts + mlf cho evaluation data
python script/generatePrompts.py d:/OneDrive/CH/CH27-02/XuLyNgonNguNoi/TH/project/project2/test_wav/ test_wav/prompts.txt
python script/vietnameseToTelex.py test_wav/prompts.txt txt/test_prompts.txt
perl script/prompts2mlf.pl mlf/test_words.mlf txt/test_prompts.txt

Tao file list
python script/listwavmfc.py d:/OneDrive/CH/CH27-02/XuLyNgonNguNoi/TH/project/project2/test_wav/ txt/test.scp txt/test_mfc.scp

Rut dac trung bo evalution
htk\HCopy -T 1 -C cfg/HCopy.cfg -S txt/test.scp

Nhan dang
htk\HVite -T 1 -C cfg/Hvite.cfg -H hmm/hmm15/macros -H hmm/hmm15/hmmdefs -S txt/test.scp -i recout.mlf -w txt/wdnet.txt txt/srcDict.txt tiedlist

Format results
htk\HResults -I mlf/test_words.mlf tiedlist recout.mlf > result.txt

